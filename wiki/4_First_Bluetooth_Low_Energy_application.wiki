#summary Loading and analysis of first Bluetooth Low Energy application on PCA 10001 board
#labels Featured,Phase-QA,Phase-Design

https://dl.dropboxusercontent.com/u/43091897/HostedFile/nRF51822_project/work-in-progress_BIG.png

<wiki:toc max_depth="4" />

= Introduction =
https://dl.dropboxusercontent.com/u/43091897/HostedFile/nRF51822_project/Bluetooth_Smart_Logo.svg.png

Bluetooth standard is a standard for personal area network allowing short range and low power. Effective ranges varies from 1 meter to 100 meter.
Bluetooth uses a radio technology called frequency hopping spread spectrum (FHSS) allowing to make a very robust link. It operates in the ISM 2.4 GHz band.

Since 1999 the SIG (Special Interest Group) has released 4 different major specifications:
 * BR (specification 1.1): Basic Rate, 1 Mbit/s;
 * EDR (specification 2.0): Enhanced Data Rate, 2 and 3 Mbit/s;
 * HS (specification 3.0): High Speed (Alternate MAC/PHY);
 * LE (specification 4.0): Low Energy, 1 Mbit/s, ultra low power;
Bluetooth low energy is not backward compatible with the older version thus SIG introduces two new terms for separate them:
 * Bluetooth Smart (4.0): Single Mode, LE only radio;
 * Bluetooth Smart Ready (4.0): Dual mode, BR/EDR and LE dual radio;

The nRF51822 support only Bluetooth low energy mode.

Bluetooth Low Energy is particularly suitable for low energy because it uses small packet to transmit information (only 27 bytes), has short TX and RX windows, there is always a race to idle (turn the radio ON as seldom as possible and turn OFF the radio as soon as possible). A connection is accomplished in only 6 ms with fast tear down (hundred of ms with Bluetooth classic). It also has a low memory footprint (8 kB RAM on nRF51822). Finally the protocol is stateless creating every request as independent transaction.

== BLE profiles ==
Profiles are definitions of possible application and specifies general behaviors that devices can use to communicate. Some examples are:
 * Hid over GATT: human Interface Device

https://dl.dropboxusercontent.com/u/43091897/HostedFile/nRF51822_project/pc-mouse_BLE.png

 * Heart Rate: Used in sport and medicine

https://dl.dropboxusercontent.com/u/43091897/HostedFile/nRF51822_project/HRMBelt_Smartphone_BLE.png

 * Proximity: proximity monitoring of two device

https://dl.dropboxusercontent.com/u/43091897/HostedFile/nRF51822_project/keyfob-tablet_BLE.png

== Bluetooth Low Energy architecture ==

https://dl.dropboxusercontent.com/u/43091897/HostedFile/nRF51822_project/BLE_architecture.png

It has tree main part: the controller, the host and the application.
 === The Controller===

Is the physical device that can transmit and receive radio signals and understand how the signals can be interpreted. It is composed by:
 * *Physical Layer (PHY)*, the nRF51 series radio module;
 * *Link Layer (LL)*, the most complex part of BLE. It has 5 main states:Standby, Advertising, Scanning, Initiating, Connection. *-Advertising*: the device is transmitting advertising packets; the only way a device can be discovered in BLE is if it is advertising and to connect to a device it must be discovered first. Advertising mode is also used for broadcasting data. *-Scanning*: the device scans for advertising packets. Are possible _passive scanning_ (only receive adv. data) and _active scanning_ (scanner requests are sent to adv devices to obtain additional scanner response data. *-Initiating* state, the device scans for advertising packets and then sends out a connect request to the advertiser. The device will then move to the connection state; *-Connection* state, has two sub-states: master and slave;

Packet structure is composed by two types of packets: Advertising packets understandable by all devices and Data packets are understandable only by 2 devices, master and slave.

BLE utilizes 40 channel separated by 2 MHz (instead of the classic 1 MHz) : 3 adv channels and 37 data channels.

Link layer is also responsible for establishment and management of connections.

E.g....
;